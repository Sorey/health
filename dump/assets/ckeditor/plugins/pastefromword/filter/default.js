/*
 Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
!function(){function t(t){t=t.toUpperCase();for(var e=r.length,i=0,n=0;e>n;++n)for(var a=r[n],l=a[1].length;t.substr(0,l)==a[1];t=t.substr(l))i+=a[0];return i}function e(t){t=t.toUpperCase();for(var e=1,i=1;0<t.length;i*=26)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(t.charAt(t.length-1))*i,t=t.substr(0,t.length-1);return e}var i=CKEDITOR.htmlParser.fragment.prototype,n=CKEDITOR.htmlParser.element.prototype;i.onlyChild=n.onlyChild=function(){var t=this.children;return 1==t.length&&t[0]||null},n.removeAnyChildWithName=function(t){for(var e,i=this.children,n=[],a=0;a<i.length;a++)e=i[a],e.name&&(e.name==t&&(n.push(e),i.splice(a--,1)),n=n.concat(e.removeAnyChildWithName(t)));return n},n.getAncestor=function(t){for(var e=this.parent;e&&(!e.name||!e.name.match(t));)e=e.parent;return e},i.firstChild=n.firstChild=function(t){for(var e,i=0;i<this.children.length;i++)if(e=this.children[i],t(e)||e.name&&(e=e.firstChild(t)))return e;return null},n.addStyle=function(t,e,i){var n="";if("string"==typeof e)n+=t+":"+e+";";else{if("object"==typeof t)for(var a in t)t.hasOwnProperty(a)&&(n+=a+":"+t[a]+";");else n+=t;i=e}this.attributes||(this.attributes={}),t=this.attributes.style||"",t=(i?[n,t]:[t,n]).join(";"),this.attributes.style=t.replace(/^;+|;(?=;)/g,"")},n.getStyle=function(t){var e=this.attributes.style;return e?(e=CKEDITOR.tools.parseCssText(e,1),e[t]):void 0},CKEDITOR.dtd.parentOf=function(t){var e,i={};for(e in this)-1==e.indexOf("$")&&this[e][t]&&(i[e]=1);return i};var a,l=/^(?:\b0[^\s]*\s*){1,4}$/,s={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},r=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],o=0,c=null,h=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(t,e){var i=new CKEDITOR.htmlParser.element("cke:listbullet");return i.attributes={"cke:listsymbol":t[0]},i.add(new CKEDITOR.htmlParser.text(e)),i},isListBulletIndicator:function(t){return/mso-list\s*:\s*Ignore/i.test(t.attributes&&t.attributes.style)?!0:void 0},isContainingOnlySpaces:function(t){var e;return(e=t.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(e.value)},resolveList:function(t){var e,i=t.attributes;return(e=t.removeAnyChildWithName("cke:listbullet"))&&e.length&&(e=e[0])?(t.name="cke:li",i.style&&(i.style=h.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(t){t=t.split(" "),t=CKEDITOR.tools.convertToPx(t[3]||t[1]||t[0]),!o&&null!==c&&t>c&&(o=t-c),c=t,i["cke:indent"]=o&&Math.ceil(t/o)+1||1}],[/^mso-list$/,null,function(t){if(t=t.split(" "),!(2>t.length)){var e=Number(t[0].match(/\d+/));t=Number(t[1].match(/\d+/)),1==t&&(e!==a&&(i["cke:reset"]=1),a=e),i["cke:indent"]=t}}]])(i.style,t)||""),i["cke:indent"]||(c=0,i["cke:indent"]=1),CKEDITOR.tools.extend(i,e.attributes),!0):(a=c=o=null,!1)},getStyleComponents:function(){var t=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);return CKEDITOR.document.getBody().append(t),function(e,i,n){t.setStyle(e,i),e={},i=n.length;for(var a=0;i>a;a++)e[n[a]]=t.getStyle(n[a]);return e}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(t,e){e="number"==typeof e?e:1;var i,n=t.attributes;switch(n.type){case"a":i="lower-alpha";break;case"1":i="decimal"}for(var l,s=t.children,r=0;r<s.length;r++)if(l=s[r],l.name in CKEDITOR.dtd.$listItem){var o=l.attributes,d=l.children,u=d[0],g=d[d.length-1];u.attributes&&u.attributes.style&&-1<u.attributes.style.indexOf("mso-list")&&(l.attributes.style=u.attributes.style,u.replaceWithChildren()),g.name in CKEDITOR.dtd.$list&&(t.add(g,r+1),--d.length||s.splice(r--,1)),l.name="cke:li",n.start&&!r&&(o.value=n.start),h.filters.stylesFilter([["tab-stops",null,function(t){(t=t.match(/0$|\d+\.?\d*\w+/))&&(c=CKEDITOR.tools.convertToPx(t[0]))}],1==e?["mso-list",null,function(t){t=t.split(" "),t=Number(t[0].match(/\d+/)),t!==a&&(o["cke:reset"]=1),a=t}]:null])(o.style),o["cke:indent"]=e,o["cke:listtype"]=t.name,o["cke:list-style-type"]=i}else if(l.name in CKEDITOR.dtd.$list){for(arguments.callee.apply(this,[l,e+1]),s=s.slice(0,r).concat(l.children).concat(s.slice(r+1)),t.children=[],l=0,d=s.length;d>l;l++)t.add(s[l]);s=t.children}delete t.name,n["cke:list"]=1},assembleList:function(i){var n,l,r,h,d,u,g=i.children;i=[];for(var m,f,p,b,v,y,C=0;C<g.length;C++)if(n=g[C],"cke:li"==n.name)if(n.name="li",l=n.attributes,p=(p=l["cke:listsymbol"])&&p.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),b=v=y=null,l["cke:ignored"])g.splice(C--,1);else{if(l["cke:reset"]&&(u=h=d=null),r=Number(l["cke:indent"]),r!=h&&(f=m=null),p){if(f&&s[f][m].test(p[1]))b=f,v=m;else for(var E in s)for(var R in s[E])if(s[E][R].test(p[1])){if("ol"!=E||!/alpha|roman/.test(R)){b=E,v=R;break}m=/roman/.test(R)?t(p[1]):e(p[1]),(!y||y>m)&&(y=m,b=E,v=R)}!b&&(b=p[2]?"ol":"ul")}else b=l["cke:listtype"]||"ol",v=l["cke:list-style-type"];if(f=b,m=v||("ol"==b?"decimal":"disc"),v&&v!=("ol"==b?"decimal":"disc")&&n.addStyle("list-style-type",v),"ol"==b&&p){switch(v){case"decimal":y=Number(p[1]);break;case"lower-roman":case"upper-roman":y=t(p[1]);break;case"lower-alpha":case"upper-alpha":y=e(p[1])}n.attributes.value=y}if(u){if(r>h)i.push(u=new CKEDITOR.htmlParser.element(b)),u.add(n),d.add(u);else{if(h>r){h-=r;for(var x;h--&&(x=u.parent);)u=x.parent}u.add(n)}g.splice(C--,1)}else i.push(u=new CKEDITOR.htmlParser.element(b)),u.add(n),g[C]=u;d=n,h=r}else u&&(u=h=d=null);for(C=0;C<i.length;C++)if(u=i[C],E=u.children,m=m=void 0,R=u.children.length,x=m=void 0,g=/list-style-type:(.*?)(?:;|$)/,h=CKEDITOR.plugins.pastefromword.filters.stylesFilter,m=u.attributes,!g.exec(m.style)){for(d=0;R>d;d++)if(m=E[d],m.attributes.value&&Number(m.attributes.value)==d+1&&delete m.attributes.value,m=g.exec(m.attributes.style)){if(m[1]!=x&&x){x=null;break}x=m[1]}if(x){for(d=0;R>d;d++)m=E[d].attributes,m.style&&(m.style=h([["list-style-type"]])(m.style)||"");u.addStyle("list-style-type",x)}}a=c=o=null},falsyFilter:function(){return!1},stylesFilter:function(t,e){return function(i,n){var a=[];(i||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(i,l,s){l=l.toLowerCase(),"font-family"==l&&(s=s.replace(/["']/g,""));for(var r,o,c,h=0;h<t.length;h++)if(t[h]&&(i=t[h][0],r=t[h][1],o=t[h][2],c=t[h][3],l.match(i)&&(!r||s.match(r))))return l=c||l,e&&(o=o||s),"function"==typeof o&&(o=o(s,n,l)),o&&o.push&&(l=o[0],o=o[1]),void("string"==typeof o&&a.push([l,o]));!e&&a.push([l,s])});for(var l=0;l<a.length;l++)a[l]=a[l].join(":");return a.length?a.join(";")+";":!1}},elementMigrateFilter:function(t,e){return t?function(i){var n=e?new CKEDITOR.style(t,e)._.definition:t;i.name=n.element,CKEDITOR.tools.extend(i.attributes,CKEDITOR.tools.clone(n.attributes)),i.addStyle(CKEDITOR.style.getStyleText(n)),n.attributes&&n.attributes["class"]&&(i.classWhiteList=" "+n.attributes["class"]+" ")}:function(){}},styleMigrateFilter:function(t,e){var i=this.elementMigrateFilter;return t?function(n,a){var l=new CKEDITOR.htmlParser.element(null),s={};s[e]=n,i(t,s)(l),l.children=a.children,a.children=[l],l.filter=function(){},l.parent=a}:function(){}},bogusAttrFilter:function(t,e){return-1==e.name.indexOf("cke:")?!1:void 0},applyStyleFilter:null},getRules:function(t,e){var i=CKEDITOR.dtd,n=CKEDITOR.tools.extend({},i.$block,i.$listItem,i.$tableContent),a=t.config,s=this.filters,r=s.falsyFilter,o=s.stylesFilter,c=s.elementMigrateFilter,h=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),d=this.utils.createListBulletMarker,u=s.flattenList,g=s.assembleList,m=this.utils.isListBulletIndicator,f=this.utils.isContainingOnlySpaces,p=this.utils.resolveList,b=function(t){return t=CKEDITOR.tools.convertToPx(t),isNaN(t)?t:t+"px"},v=this.utils.getStyleComponents,y=this.utils.listDtdParents,C=!1!==a.pasteFromWordRemoveFontStyles,E=!1!==a.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(t){t.filterChildren(e),g(t)},elements:{"^":function(t){var e;CKEDITOR.env.gecko&&(e=s.applyStyleFilter)&&e(t)},$:function(t){var l=t.name||"",s=t.attributes;if(l in n&&s.style&&(s.style=o([[/^(:?width|height)$/,null,b]])(s.style)||""),l.match(/h\d/)){if(t.filterChildren(e),p(t))return;c(a["format_"+l])(t)}else if(l in i.$inline)t.filterChildren(e),f(t)&&delete t.name;else if(-1!=l.indexOf(":")&&-1==l.indexOf("cke")){if(t.filterChildren(e),"v:imagedata"==l)return(l=t.attributes["o:href"])&&(t.attributes.src=l),void(t.name="img");delete t.name}l in y&&(t.filterChildren(e),g(t))},style:function(t){if(CKEDITOR.env.gecko){t=(t=t.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&t[1];var e={};t&&(t.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(t,i,n){i=i.split(","),t=i.length;for(var a=0;t>a;a++)CKEDITOR.tools.trim(i[a]).replace(/^(\w+)(\.[\w-]+)?$/g,function(t,i,a){i=i||"*",a=a.substring(1,a.length),a.match(/MsoNormal/)||(e[i]||(e[i]={}),a?e[i][a]=n:e[i]=n)})}),s.applyStyleFilter=function(t){var i=e["*"]?"*":t.name,n=t.attributes&&t.attributes["class"];i in e&&(i=e[i],"object"==typeof i&&(i=i[n]),i&&t.addStyle(i,!0))})}return!1},p:function(t){if(/MsoListParagraph/i.exec(t.attributes["class"])||t.getStyle("mso-list")&&!t.getStyle("mso-list").match(/^(none|skip)$/i)){var i=t.firstChild(function(t){return t.type==CKEDITOR.NODE_TEXT&&!f(t.parent)});(i=i&&i.parent)&&i.addStyle("mso-list","Ignore")}t.filterChildren(e),p(t)||(a.enterMode==CKEDITOR.ENTER_BR?(delete t.name,t.add(new CKEDITOR.htmlParser.element("br"))):c(a["format_"+(a.enterMode==CKEDITOR.ENTER_P?"p":"div")])(t))},div:function(t){var e=t.onlyChild();if(e&&"table"==e.name){var i=t.attributes;e.attributes=CKEDITOR.tools.extend(e.attributes,i),i.style&&e.addStyle(i.style),e=new CKEDITOR.htmlParser.element("div"),e.addStyle("clear","both"),t.add(e),delete t.name}},td:function(t){t.getAncestor("thead")&&(t.name="th")},ol:u,ul:u,dl:u,font:function(t){if(m(t.parent))delete t.name;else{t.filterChildren(e);var i=t.attributes,n=i.style,a=t.parent;"font"==a.name?(CKEDITOR.tools.extend(a.attributes,t.attributes),n&&a.addStyle(n),delete t.name):(n=(n||"").split(";"),i.color&&("#000000"!=i.color&&n.push("color:"+i.color),delete i.color),i.face&&(n.push("font-family:"+i.face),delete i.face),i.size&&(n.push("font-size:"+(3<i.size?"large":3>i.size?"small":"medium")),delete i.size),t.name="span",t.addStyle(n.join(";")))}},span:function(t){if(m(t.parent))return!1;if(t.filterChildren(e),f(t))return delete t.name,null;if(m(t)){var i=t.firstChild(function(t){return t.value||"img"==t.name}),n=(i=i&&(i.value||"l."))&&i.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(n)return i=d(n,i),(t=t.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(t.attributes.style)&&(i.attributes["cke:ignored"]=1),i}return(n=(i=t.attributes)&&i.style)&&(i.style=o([["line-height"],[/^font-family$/,null,C?null:h(a.font_style,"family")],[/^font-size$/,null,C?null:h(a.fontSize_style,"size")],[/^color$/,null,C?null:h(a.colorButton_foreStyle,"color")],[/^background-color$/,null,C?null:h(a.colorButton_backStyle,"color")]])(n,t)||""),i.style||delete i.style,CKEDITOR.tools.isEmpty(i)&&delete t.name,null},b:c(a.coreStyles_bold),i:c(a.coreStyles_italic),u:c(a.coreStyles_underline),s:c(a.coreStyles_strike),sup:c(a.coreStyles_superscript),sub:c(a.coreStyles_subscript),a:function(t){var e=t.attributes;e.name&&e.name.match(/ole_link\d+/i)?delete t.name:e.href&&e.href.match(/^file:\/\/\/[\S]+#/i)&&(e.href=e.href.replace(/^file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(t){t.getAncestor(/h\d/)&&!a.pasteFromWordNumberedHeadingToList&&delete t.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:o(E?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(t,e,i){if(e.name in{p:1,div:1}){if(e="ltr"==a.contentsLangDirection?"margin-left":"margin-right","margin"==i)t=v(i,t,[e])[e];else if(i!=e)return null;if(t&&!l.test(t))return[e,t]}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(t,e){return"img"==e.name?t:void 0}],[/^width|height$/,null,function(t,e){return e.name in{table:1,td:1,th:1,img:1}?t:void 0}]]:[[/^mso-/],[/-color$/,null,function(t){return"transparent"==t?!1:CKEDITOR.env.gecko?t.replace(/-moz-use-text-color/g,"transparent"):void 0}],[/^margin$/,l],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],C?[/font-?/]:null],E),width:function(t,e){return e.name in i.$tableContent?!1:void 0},border:function(t,e){return e.name in i.$tableContent?!1:void 0},"class":function(t,e){return e.classWhiteList&&-1!=e.classWhiteList.indexOf(" "+t+" ")?t:!1},bgcolor:r,valign:E?r:function(t,e){return e.addStyle("vertical-align",t),!1}},comment:CKEDITOR.env.ie?r:function(t,e){var i=t.match(/<img.*?>/),n=t.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return n?(n=(i=n[1]||i&&"l.")&&i.match(/>(?:[(]?)([^\s]+?)([.)]?)</),d(n,i)):CKEDITOR.env.gecko&&i?(i=CKEDITOR.htmlParser.fragment.fromHtml(i[0]).children[0],(n=(n=(n=e.previous)&&n.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&n[1])&&(i.attributes.src=n),i):!1}}}},d=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};d.prototype={toHtml:function(t){t=CKEDITOR.htmlParser.fragment.fromHtml(t);var e=new CKEDITOR.htmlParser.basicWriter;return t.writeHtml(e,this.dataFilter),e.getHtml(!0)}},CKEDITOR.cleanWord=function(t,e){t=t.replace(/<!\[([^\]]*?)\]>/g,"<!--[$1]-->"),CKEDITOR.env.gecko&&(t=t.replace(/(\x3c!--\[if[^<]*?\])--\x3e([\S\s]*?)\x3c!--(\[endif\]--\x3e)/gi,"$1$2$3")),CKEDITOR.env.webkit&&(t=t.replace(/(class="MsoListParagraph[^>]+>\x3c!--\[if !supportLists\]--\x3e)([^<]+<span[^<]+<\/span>)(\x3c!--\[endif\]--\x3e)/gi,"$1<span>$2</span>$3"));var i=new d,n=i.dataFilter;n.addRules(CKEDITOR.plugins.pastefromword.getRules(e,n)),e.fire("beforeCleanWord",{filter:n});try{t=i.toHtml(t)}catch(a){e.showNotification(e.lang.pastefromword.error)}return t=t.replace(/cke:.*?".*?"/g,""),t=t.replace(/style=""/g,""),t=t.replace(/<span>/g,"")}}();